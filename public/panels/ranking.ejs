<div class="ranking">
    <div id="rankingDisplay" class="rankingSide">
        <div id="playerImage"></div>
    </div>
    <div class="rankingSide">       
        <%
        let player;
        let i = 0;
        let percent = 0;
        players.forEach((player)=>{
            i++;
            let percent = Math.floor((player.exp / expTable[player.level])*100);
        %>
                <div class="rankingPlayer" id="<%= player.name %>" >
                <h3 data-beforeContent="#<%= i %>"><%= player.name %></h3>
                <h3 data-beforeContent="Level"><%= player.level %></h3>
                <h5><%= percent %>% (<%= player.exp %>exp)</h5>
                <div class="playerExpBar" style="width:<%= percent %>%"></div>
            </div>
        <% }); %>
    </div>      
</div>
<script>
    let playerImages = 
        {
        <%
        players.forEach((player)=>{
        %> 
        <%= player.name %>:"http://localhost:8081/Characters/<%= player.name %>.chr",
        <%});%>
        };
    let lastClicked = -1;
    let mainColor = window.getComputedStyle(document.body).getPropertyValue("--mainColor");
    let image = document.getElementById("playerImage");
    let players = document.getElementsByClassName("rankingPlayer");
    for(let i = 0; i < players.length; i++){
        players[i].addEventListener("click",function()
        {
            console.log(this);
            console.log(playerImages[this.id]);
            image.style.background="url("+playerImages[this.id]+") no-repeat";
            image.style.backgroundSize="contain";
            image.style.backgroundPosition="50% 100%";
            this.style.boxShadow = "inset 0px -0.2em 0em rgba(0, 0, 0, 0.08),inset 0.6em 0 0 " + mainColor;
            if(lastClicked != -1 && this != lastClicked)
                lastClicked.style.boxShadow = "inset 0px -0.2em 0em rgba(0, 0, 0, 0.08),inset 0em 0 0 "+ mainColor;
            lastClicked = this;    
        },false);
    }
</script>
